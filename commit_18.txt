Commit 18: Final performance optimization
